A = rgb2gray(imread('lowContrast.png'));
figure;
imshow(A,[]);
title('Low Contrast Image');
[R C] = size(A);
B = zeros(R,C);

filter_size = 3;
L =256
cdf = zeros(1,L);
lut = zeros(1,L);


for i=1:1:R
    for j =1:1:C
        block = A(i : i + filter_size, j : j + filter_size);
        cdf_block = cumsum(imhist(block)) / (filter_size * filter_size);
        lut = cdf_block .* (L-1);
        B(i,j) = lut(A(i,j)+1);
    end
end

figure;
imshow(B,[]);
title('Histogram Equalized Image');